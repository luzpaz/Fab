<h1>Tree:</h1>
<p>Tree: Fab tree management.</p>
<p>The Tree package provides a tree of nodes that mostly corresponds to a FreeCAD tree
as shown in the FreeCAD model view.</p>
<p>The base class is FabNode organized as follows:</p>
<ul>
<li>FabNode: Tree node base class (can be either a &quot;leaf&quot; or &quot;interior node.)
(This needs to be expanded.)</li>
</ul>
<p>The Tree enforces the following constraints:</p>
<ul>
<li>Each FabNode name must be compatible with a Python variable name
(i.e. upper/lower letters, digits, and underscores with the character being a letter.)</li>
<li>All of the children of a FabNode must have distinct names.</li>
<li>A node may occur only once in the Tree (i.e. DAG = Direct Acyclic Graph.)</li>
<li>The FabRoot must be named 'Root'.</li>
</ul>
<p>Each FabNode has a <em>FullPath</em> property which is string that contains the FabNode Names
from the FabRoot downwards separated by a '.'.  The &quot;Root.&quot; is skipped because it is redundant.
Each FabNode has an Parent attribute that specifies the parent FabNode</p>
<p>FabNode implement</p>
<p>The FabNode base class implements three recursive methods:</p>
<ul>
<li>configure() -&gt; Tuple[str, ...]:
Recursively propagate configuration values during the configuration phase.
All configured values are returns a tuple of strings of the form &quot;FULL_NAME:PROPERTY_NAME:VALUE&quot;.</li>
<li>check(context) -&gt; Tuple[str, ...]:
Recursively checks for errors during the check phase and returns a tuple of error strings.</li>
<li>build(context) -&gt; Tuple[str, ...]:
Recursively used to build the model and generate any production files (CNC, STL, DWG, etc.)
Any errors and warnings are returned as a tuple of strings.</li>
</ul>
<p>The <em>check</em> and <em>build</em> methods take an <em>context</em> argument which is a dictionarly (Dict[str, Any].)
Values are inserted to communication information from a high node to the lower tree nodes.
The higher level node stuffs a value into the dictionary and lower values can read them back.
Any values stuffed into a lower level are not accessed by the upper level because by convention
each recursion step makes a shallow dictionary copy of the context before passing down to the
next level down.  This is shown below:</p>
<pre><code> # Iterate across children FabNode's:
 for child in self.Children:
     child.visit(context.copy(), ...)
</code></pre>
<p>There are currently 1 &quot;invisible&quot; and 3 user visible recursion phases:</p>
<ul>
<li>Setup Phase:
This phase does consistency checking and fills in values such as FullPath.
There are no user hooks in this phase.</li>
<li>Configuration Phase:
The configuration phase is where constraints get propagated between FabNode's.  Each
FabNode recomputes its configuration value using a method called <em>configure</em>.  This method
can do this by read other values from other FabNode's elsewhere in FabRoot tree then
computing new values.  This is done repeatably until no more configuration values change or
until it is pretty clear that there is cyclic dependency will not converge.  When convergence
fails, the list of configuration values that did not stabilize are presented.  If there are no
convergence issues, the next phase occurs.</li>
<li>Check Phase:
The check phase recursively performs sanity checking for each FabNode in the tree.
The result is a list of error messages.  If the are no errors, the next phase occurs.</li>
<li>Build Phase:
The build phase recursively performs the build operations.  This includes generating
the FreeCAD solids/assemblies and the associated output files.</li>
</ul>
<h2>Table of Contents (alphabetical order):</h2>
<ul>
<li>1 Class: <a href="#tree--fabbox">FabBox</a>:
<ul>
<li>1.1 <a href="#tree----enclose">enclose()</a>: Initialize a FabBox.</li>
<li>1.2 <a href="#tree----reorient">reorient()</a>: Reorient FabBox given a Placement.</li>
<li>1.3 <a href="#tree----intersect">intersect()</a>: Compute Line Segment intersection with a FabBox.</li>
</ul>
</li>
<li>2 Class: <a href="#tree--fabnode">FabNode</a>:
<ul>
<li>2.1 <a href="#tree----get-construct">get_construct()</a>: Return construct flag.</li>
<li>2.2 <a href="#tree----pre-produce">pre_produce()</a>: Empty FabNode pre_produce method to be over-ridden as needed.</li>
<li>2.3 <a href="#tree----produce">produce()</a>: Empty FabNode produce method to be over-ridden.</li>
<li>2.4 <a href="#tree----post-produce">post_produce()</a>: Empty FabNode post_produce method to be over-ridden as needed.</li>
<li>2.5 <a href="#tree----set-tracing">set_tracing()</a>: Set the FabNode indentation tracing level.</li>
<li>2.6 <a href="#tree----probe">probe()</a>: Perform a probe operation.</li>
<li>2.7 <a href="#tree----configure">configure()</a>: Configure FabNode.</li>
<li>2.8 <a href="#tree----configurations-append">configurations_append()</a>: Append specified attributes to configurations list.</li>
</ul>
</li>
</ul>
<h2><a name="tree--fabbox"></a>1 Class FabBox:</h2>
<p>X/Y/Z Axis Aligned Cubiod.
An FabBox is represents a cuboid (i.e. a rectangular parallelpiped, or right prism) where
the edges are aligned with the X, Y, and Z axes.  This is basically equivalent to the FreeCAD
BoundBox object, but with way more attributes to access various points on the cuboid surface.</p>
<p>The basic attribute nomenclature is based on the compass points North (+Y), South (-Y),
East (+X) and West (-X).  Two additional &quot;compass&quot; points call Top (+Z) and Bottom (-Z)
are introduced as well.</p>
<p>Thus:</p>
<ul>
<li>TNE represents the Top North East corner of the box.</li>
<li>NE represents the center of the North East box edge.</li>
<li>T represents the center of the top face of the box.</li>
</ul>
<p>Attributes:</p>
<ul>
<li>Minimums/Maximums:
<ul>
<li>XMax (float): The maximum X (East).</li>
<li>XMin (float): The minumum X (West).</li>
<li>YMax (float): The maximum Y (North).</li>
<li>YMin (float): The minimum Y (South).</li>
<li>ZMax (float): The maximum Z (Top).</li>
<li>ZMin (float): The minimum Z (Bottom).</li>
</ul>
</li>
<li>The 6 face attributes:
<ul>
<li>B (Vector): Center of bottom face.</li>
<li>E (Vector): Center of east face.</li>
<li>N (Vector): Center of north face.</li>
<li>S (Vector): Center of south face.</li>
<li>T (Vector): Center of top face.</li>
<li>W (Vector): Center of west face.</li>
</ul>
</li>
<li>The 8 corner attributes:
<ul>
<li>BNE (Vector): Bottom North East corner.</li>
<li>BNW (Vector): Bottom North West corner.</li>
<li>BSE (Vector): Bottom South East corner.</li>
<li>BSW (Vector): Bottom South West corner.</li>
<li>TNE (Vector): Top North East corner.</li>
<li>TNW (Vector): Top North West corner.</li>
<li>TSE (Vector): Top South East corner.</li>
<li>TSW (Vector): Bottom South West corner.</li>
</ul>
</li>
<li>The 12 edge attributes:
<ul>
<li>BE (Vector): Center of Bottom East edge.</li>
<li>BN (Vector): Center of Bottom North edge.</li>
<li>BS (Vector): Center of Bottom South edge.</li>
<li>BW (Vector): Center of Bottom West edge.</li>
<li>NE (Vector): Center of North East edge</li>
<li>NW (Vector): Center of North West edge</li>
<li>SE (Vector): Center of South East edge</li>
<li>SW (Vector): Center of South West edge</li>
<li>TE (Vector): Center of Top East edge.</li>
<li>TN (Vector): Center of Top North edge.</li>
<li>TS (Vector): Center of Top South edge.</li>
<li>TW (Vector): Center of Top West edge.</li>
</ul>
</li>
<li>The other attributes:
<ul>
<li>BB (BoundBox): The FreeCAD BoundBox object.</li>
<li>C (Vector): Center point.</li>
<li>DB (Vector): Bottom direction (i.e. B - C)</li>
<li>DE (Vector): East direction (i.e. E - C)</li>
<li>DN (Vector): North direction (i.e. N - C)</li>
<li>DS (Vector): South direction (i.e. S - C)</li>
<li>DT (Vector): Top direction (i.e. T - C)</li>
<li>DW (Vector): West direction (i.e. W - C)</li>
<li>DX (float): X box length (i.e. (E - W).Length)</li>
<li>DY (float): Y box length (i.e. (N - S).Length)</li>
<li>DZ (float): Z box length (i.e. (T - B).Length)</li>
</ul>
</li>
</ul>
<h3><a name="tree----enclose"></a>1.1 <code>FabBox.</code>enclose():</h3>
<p>FabBox.enclose(self, bounds: typing.Sequence[typing.Union[Base.Vector, Base.BoundBox, ForwardRef('FabBox')]]) -&gt; None:</p>
<p>Initialize a FabBox.
Arguments:</p>
<ul>
<li><em>bounds</em> (Sequence[Union[Vector, BoundBox, FabBox]]):
A sequence of points or boxes to enclose.</li>
</ul>
<p>Raises:</p>
<ul>
<li>ValueError: For bad or empty corners.</li>
</ul>
<h3><a name="tree----reorient"></a>1.2 <code>FabBox.</code>reorient():</h3>
<p>FabBox.reorient(self, placement: Base.Placement) -&gt; 'FabBox':</p>
<p>Reorient FabBox given a Placement.
Note after the <em>placement</em> is applied, the resulting box is still rectilinear with the
X/Y/Z axes.  In particular, box volume is <em>not</em> conserved.</p>
<p>Arguments:</p>
<ul>
<li><em>placement</em> (Placement): The placement of the box corners.</li>
</ul>
<h3><a name="tree----intersect"></a>1.3 <code>FabBox.</code>intersect():</h3>
<p>FabBox.intersect(self, segment_start: Base.Vector, segment_end: Base.Vector, tracing: str = '') -&gt; typing.Tuple[bool, float, float]:</p>
<p>Compute Line Segment intersection with a FabBox.
Arguments:</p>
<ul>
<li><em>segment_start</em> (Vector): Start point of the line segment.</li>
<li><em>segment_end</em> (Vector): End point of the line segment.</li>
</ul>
<p>Returns:</p>
<ul>
<li>(bool): True is some portion of the line segment is inside of the FabBox.</li>
<li>(Vector): When True, the possibly truncated line segment point near <em>segment_start</em>.</li>
<li>(Vector): When True, the possibly truncated line segment point near <em>segment_end</em>.</li>
</ul>
<h2><a name="tree--fabnode"></a>2 Class FabNode:</h2>
<p>Represents one node in the tree.
Attributes:</p>
<ul>
<li><em>Name</em> (str): The FabNode name.</li>
<li><em>Up</em> (FabNode): The FabNode parent.</li>
<li><em>FullPath</em> (str):  The FabNode full path from the root.  (Filled in)</li>
<li><em>Context</em> (Dict[str, Any]): A context dictionary used during production.</li>
<li><em>Tracing</em> (str):
A non-empty indentation string when tracing is enabled.
This field is recursively set when <em>set_tracing</em>() is explicitly set.</li>
</ul>
<h3><a name="tree----get-construct"></a>2.1 <code>FabNode.</code>get_construct():</h3>
<p>FabNode.get_construct(self) -&gt; bool:</p>
<p>Return construct flag.
This method is overridden in FabProject only and should be call the only one called.
If this method is actually called, something is seriously wrong.</p>
<h3><a name="tree----pre-produce"></a>2.2 <code>FabNode.</code>pre_produce():</h3>
<p>FabNode.pre_produce(self) -&gt; typing.Tuple[str, ...]:</p>
<p>Empty FabNode pre_produce method to be over-ridden as needed.</p>
<h3><a name="tree----produce"></a>2.3 <code>FabNode.</code>produce():</h3>
<p>FabNode.produce(self) -&gt; typing.Tuple[str, ...]:</p>
<p>Empty FabNode produce method to be over-ridden.</p>
<h3><a name="tree----post-produce"></a>2.4 <code>FabNode.</code>post_produce():</h3>
<p>FabNode.post_produce(self) -&gt; typing.Tuple[str, ...]:</p>
<p>Empty FabNode post_produce method to be over-ridden as needed.</p>
<h3><a name="tree----set-tracing"></a>2.5 <code>FabNode.</code>set_tracing():</h3>
<p>FabNode.set_tracing(self, tracing: str):</p>
<p>Set the FabNode indentation tracing level.
This typically done, by adding this call immediately after calling super().<strong>post_init</strong>().</p>
<pre><code> @dataclass
 class MySubClass(Node):   # Or some class descended from Node*.
    '''MySubClass doc string.'''

    super().__post_init__()
    self.set_tracing(&quot; &quot;)  # Set the tracing here.
    # All children nodes will that are added, will have tracing set as well.
</code></pre>
<h3><a name="tree----probe"></a>2.6 <code>FabNode.</code>probe():</h3>
<p>FabNode.probe(self, label: str) -&gt; None:</p>
<p>Perform a probe operation.
This method can be overriden and called to perform debug probes.</p>
<h3><a name="tree----configure"></a>2.7 <code>FabNode.</code>configure():</h3>
<p>FabNode.configure(self, tracing: str = '') -&gt; None:</p>
<p>Configure FabNode.</p>
<h3><a name="tree----configurations-append"></a>2.8 <code>FabNode.</code>configurations_append():</h3>
<p>FabNode.configurations_append(self, configurations: typing.List[str], tracing: str = '') -&gt; None:</p>
<p>Append specified attributes to configurations list.</p>
